<!DOCTYPE html>
<html>
<head>
    <title>半自動共有ツールPro</title>
    <style>
        #info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            font-size: 16px;
            color: gray;
        }
    </style>
</head>
<body>
    <input type="text" placeholder="テキスト 1" id="textInput1">
    <input type="number" id="textCount" placeholder="追加するテキストの数">
    <button id="createInputsButton">テキストを追加</button>
    <div id="inputs"></div>
    <input type="number" id="redirectInterval" placeholder="リダイレクト間隔（ミリ秒）">
    <div id="redirectCountInfo"></div>
    <button id="startRedirectButton">リダイレクト開始</button>
    <button id="stopRedirectButton">リダイレクト停止</button>
    <div id="info">ver. 0.04</div>

    <script>
        let redirectTimer;
        let textInputs = [];
        let redirectCount = 0;

        document.getElementById("createInputsButton").addEventListener("click", function() {
            const textCount = parseInt(document.getElementById("textCount").value);
            if (textCount > 0) {
                const inputsDiv = document.getElementById("inputs");

                for (let i = 0; i < textCount; i++) {
                    const textInput = document.createElement("input");
                    textInput.type = "text";
                    textInput.placeholder = `テキスト ${i + 2}`;
                    textInputs.push(textInput);
                    inputsDiv.appendChild(textInput);
                }
            } else {
                alert("テキストの数は正の整数で指定してください.");
            }
        });

        document.getElementById("startRedirectButton").addEventListener("click", function() {
            const redirectInterval = parseInt(document.getElementById("redirectInterval").value);

            if (redirectInterval > 0) {
                if (textInputs.length > 0) {
                    redirectTimer = setInterval(function() {
                        for (let i = 0; i < textInputs.length; i++) {
                            const textInput = textInputs[i];
                            const customText = textInput.value;

                            if (customText) {
                                const encodedText = encodeURIComponent(customText);
                                const finalRedirectLink = `line://share?text=${encodedText}`;
                                window.location.href = finalRedirectLink;
                                redirectCount++;
                                updateRedirectCount();
                            }
                        }
                    }, redirectInterval);
                    alert("リダイレクトが開始しました.");
                } else {
                    alert("テキストを追加してください.");
                }
            } else {
                alert("リダイレクト間隔は正の値で指定してください.");
            }
        });

        document.getElementById("stopRedirectButton").addEventListener("click", function() {
            clearInterval(redirectTimer);
            alert("リダイレクトが停止しました.");
        });

        // リダイレクト回数を表示
        function updateRedirectCount() {
            const redirectCountInfo = document.getElementById("redirectCountInfo");
            redirectCountInfo.textContent = `リダイレクト回数: ${redirectCount}`;
        }

        // リダイレクト回数を初期化
        updateRedirectCount();
    </script>
</body>
</html>
